/* eslint-disable no-alert */
(()=>{function e(e,s){e.open("GET",s),e.setRequestHeader("Client-ID","ny29dihtbce4ubq6bvgupsrojiv8uf"),e.setRequestHeader("Accept","application/vnd.twitchtv.v5+json"),e.send()}function s(e){e.onload=function(){if(e.status>=200&&t.status<300){let s=JSON.parse(e.response);try{s=JSON.parse(e.response)}catch(e){console.log(e)}JSON.parse(e.response).streams.forEach((e=>document.querySelector(".box__wrapper").appendChild(function(e,s){let t=document.createElement("div");return t.innerHTML='<a href="$url" class="box">  \n                            <div class="preview__placeholder">\n                                <img class="preview" src="$preview" alt="" onload="this.style.opacity=1">\n                            </div>\n                            <div class="detail">\n                                <img class="logo" src="$logo" alt="">\n                                <div class="word">\n                                    <span class="status">$status</span>\n                                    <div class="display_name__wrapper">\n                                        <span class="display__name">$display_name</span>\n                                        <div class="viewers__wrapper">\n                                            <span class="redSpot" > </span>\n                                            <span class="viewers">$viewers</span>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </a>'.replace("$url",e.channel.url).replace("$preview",e.preview.medium).replace("$viewers",e.viewers).replace("$status",e.channel.status).replace("$logo",e.channel.logo).replace("$display_name",e.channel.display_name),t}(e))))}e.status>=400&&e.status<500&&console.log("狀態碼錯誤")}}const t=new XMLHttpRequest;e(t,"https://api.twitch.tv/kraken/games/top?limit=5"),t.onload=function(){if(t.status>=200&&t.status<300){let a=JSON.parse(t.response);try{a=JSON.parse(t.response)}catch(e){console.log(e)}const n=JSON.parse(t.response),r=n.top[0].game.name;for(let e=0;e<5;e++){const s=document.createElement("span");s.classList.add("topGame"),s.innerHTML=n.top[e].game.name,document.querySelector(".navbar__game").appendChild(s)}document.querySelector(".game__name").innerHTML=n.top[0].game.name;const o=new XMLHttpRequest;e(o,`https://api.twitch.tv/kraken/streams/?game=${r}&limit=20`),s(o)}t.status>=400&&t.status<500&&console.log("狀態碼錯誤")},document.querySelector(".navbar__game").addEventListener("click",(function(t){const a=t.target.closest("span").innerHTML;if(t.target.classList.contains("topGame")){const e=document.querySelector(".alive");e&&e.classList.remove("alive"),document.querySelector(".game__name").innerHTML=a,document.querySelector(".box__wrapper").innerHTML=""}const n=new XMLHttpRequest;e(n,`https://api.twitch.tv/kraken/streams/?game=${a}&limit=20`),s(n),t.target.classList.toggle("alive")}))})();